(this["webpackJsonpbms-pro"]=this["webpackJsonpbms-pro"]||[]).push([[65],{2110:function(e,t){},2112:function(e,t){},2123:function(e,t){},2125:function(e,t){},2152:function(e,t){},2154:function(e,t){},2155:function(e,t){},2161:function(e,t){},2163:function(e,t){},2181:function(e,t){},2183:function(e,t){},2195:function(e,t){},2198:function(e,t){},2606:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(4),i=a(192),o=a(18),c=a(25),l=a(30),m=a(29),u=a(0),g=a.n(u),d=a(1002),p=a(999),h=a(96),f=a(3),b=a.n(f),S=a(45),v=a(59),E=a(190),w=a(39),N=a(49),O=a(2108);a(2224).config();var A=function(e){var t="qjn8o6V29RIlN1ba2GbRYIz8af7Gchw6Aie0TrBiRqo=".slice(0,16),a=O.enc.Utf8.parse(t);console.log("KEY",t);var n=O.enc.Utf8.parse(e.substring(0,16)),s=O.pad.Pkcs7,r=O.mode.CBC,i=e.substring(16);return O.AES.decrypt(i,a,{iv:n,mode:r,padding:s}).toString(O.enc.Utf8)},R=a(2227),x=a.n(R),C=a(1413),_=a.n(C),k=a(933),P=p.object().shape({email:p.string().email("Invalid email").required("email is required"),password:p.string().min(8,"Password must be 8 character long").required("password is required")}),y=function(e){Object(l.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={email:"",password:"",app_settings:{SYSTEM_AUTHENTICATION:{},SYSTEM_ALIASES:{}},loadingSettings:!0,isSubmitting:!1,PRIMARY_COLOR:"rgb(36,47,106)",SECONDARY_COLOR:"rgb(23,162,184)"},n.getUserFromParams=function(e){var t=e.usn,a=e.usac,n=A(t),s=A(a);return console.log({email:n,password:s}),{email:"er@er.com",password:"password123"}},n.handleChange=function(e){e.persist(),n.setState(Object(i.a)({},e.target.name,e.target.value))},n.handleSubmit=function(){var e=Object(r.a)(s.a.mark((function e(t,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.isSubmitting,n.setState({isSubmitting:!0}),e.next=4,n.props.loginWithEmailAndPassword(t);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.getAppSettings=Object(r.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,t=n.state.loadingSettings,t=!0,e.next=5,n.setState({loadingSettings:t});case 5:n.appMainService.getAppSettings().then(function(){var e=Object(r.a)(s.a.mark((function e(a){var r,i,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a.SYSTEM_AUTHENTICATION,i=a.SERVER_URL,o=a.PRIMARY_COLOR,c=a.SECONDARY_COLOR,t="ACTIVE_DIRECTORY"==r,w.a.setAppSettings(a),t&&(window.location.href="".concat(i,"/ad/logon")),n.setState({loadingSettings:t,app_settings:a,PRIMARY_COLOR:o,SECONDARY_COLOR:c}),console.log("app_settings",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t=!1,n.setState({loadingSettings:t})}));case 6:case"end":return e.stop()}}),e)}))),n.setAppSettings=function(e){var t=n.state.app_settings;e.forEach((function(e){var a=e.NAME;t[a]=e})),n.setState({app_settings:t}),console.log("APP SETTINGS Response",t)},n.appMainService=new E.a,n}return Object(c.a)(a,[{key:"componentWillReceiveProps",value:function(e){var t=e.login;t.success||t.loading||this.setState({isSubmitting:!1})}},{key:"componentDidMount",value:function(){var e=Object(r.a)(s.a.mark((function e(){var t,a,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.loadingSettings,a=_.a.parse(this.props.location.search),e.prev=2,Object.keys(a).length){e.next=8;break}return e.next=6,this.getAppSettings();case 6:e.next=19;break;case 8:if(!(n=a.AD_LOGON)||"ERROR"!=n){e.next=14;break}new N.a({type:"error",msg:"Active directory logon failed. Please login here or contact Admin."}),this.setState({loadingSettings:!1}),e.next=19;break;case 14:return e.next=16,this.getUserFromParams(a);case 16:r=e.sent,this.props.loginWithEmailAndPassword(r),this.setState({loadingSettings:t});case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(2),new N.a({type:"error",msg:"Access attempt failed. Please try again or contact admin."}),this.setState({loadingSettings:!1});case 25:case"end":return e.stop()}}),e,this,[[2,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.loadingSettings,n=t.PRIMARY_COLOR,s=(t.SECONDARY_COLOR,t.app_settings);return a?g.a.createElement(x.a,{active:a,spinner:!0,text:"Resolving Authentication ..."},g.a.createElement("div",{className:"full-screen"},g.a.createElement("img",{src:"/assets/images/logo.png",alt:"Logo",className:"modal-logox"}))):g.a.createElement("div",{className:"auth-layout-wrap",style:{backgroundImage:"url(/assets/images/user-depts_bg.png)"}},g.a.createElement("div",{className:"auth-content shadow-lg"},g.a.createElement("div",{className:"card o-hidden"},g.a.createElement("div",{className:"row"},g.a.createElement("div",{className:"col-md-6"},g.a.createElement("div",{className:"p-4"},g.a.createElement("div",{className:"auth-logo text-center mb-4"},g.a.createElement("img",{src:"/assets/images/logo.png",alt:""})),g.a.createElement("h1",{className:"mb-3 text-18"},"Sign In"),g.a.createElement(d.b,{initialValues:this.state,validationSchema:P,onSubmit:this.handleSubmit},(function(t){var a=t.values,s=t.errors,r=(t.touched,t.handleChange),i=t.handleBlur,o=t.handleSubmit;t.isSubmitting;return g.a.createElement("form",{onSubmit:o},g.a.createElement("div",{className:"form-group"},g.a.createElement("label",{htmlFor:"email"},"Email address"),g.a.createElement("input",{className:"form-control form-control-rounded position-relative",type:"email",name:"email",onChange:r,onBlur:i,value:a.email}),s.email&&g.a.createElement("div",{className:"text-danger mt-1 ml-2"},s.email)),g.a.createElement("div",{className:"form-group"},g.a.createElement("label",{htmlFor:"password"},"Password"),g.a.createElement("input",{className:"form-control form-control-rounded",type:"password",name:"password",onChange:r,onBlur:i,value:a.password}),s.password&&g.a.createElement("div",{className:"text-danger mt-1 ml-2"},s.password)),g.a.createElement("button",{className:"btn btn-rounded text-white btn-block mt-2",type:"submit",disabled:e.state.isSubmitting,style:{backgroundColor:n}},"Sign In ",e.state.isSubmitting?g.a.createElement(k.h,{className:"spin"}):null))})),g.a.createElement("div",{className:"mt-3 text-center"},g.a.createElement(v.a,{to:"/forgot-password",className:"text-muted"},g.a.createElement("u",null,"Forgot Password?"))))),g.a.createElement("div",{className:"col-md-6 text-center ",style:{backgroundSize:"cover",backgroundImage:"url(/assets/images/photo-long-3.jpg)"}},g.a.createElement("div",{className:"auth-right"},g.a.createElement("h3",{className:"text-white mb-1"},g.a.createElement("em",null,null===s||void 0===s?void 0:s.COMPANY_NAME)),g.a.createElement("h4",{className:"text-white"},g.a.createElement("b",null,"Budget Management Portal"))))))))}}]),a}(u.Component);t.default=Object(S.b)((function(e){return{loginWithEmailAndPassword:b.a.func.isRequired,user:e.user,login:e.login,isSubmitting:e.isSubmitting}}),{loginWithEmailAndPassword:h.e})(y)}}]);
//# sourceMappingURL=65.cf3968c8.chunk.js.map